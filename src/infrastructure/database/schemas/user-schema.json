{
  "version": "2.0.0",
  "metadata": {
    "name": "Dependency Linker Database Schema",
    "description": "User-friendly database configuration for the dependency tracking system",
    "author": "context-action",
    "lastUpdated": "2025-01-20"
  },
  
  "databases": {
    "files": {
      "display_name": "Project Files",
      "description": "Central repository for all project files with their metadata and relationships",
      "icon": "üìÅ",
      "category": "core",
      
      "properties": {
        "file_path": {
          "type": "text",
          "display_name": "File Path",
          "description": "Relative path from project root",
          "required": true,
          "searchable": true
        },
        
        "size_bytes": {
          "type": "number",
          "display_name": "Size (bytes)",
          "description": "File size in bytes",
          "format": "bytes"
        },
        
        "extension": {
          "type": "select",
          "display_name": "Extension",
          "description": "File extension type",
          "options": [
            { "value": ".ts", "label": "TypeScript", "color": "blue" },
            { "value": ".tsx", "label": "TypeScript React", "color": "purple" },
            { "value": ".js", "label": "JavaScript", "color": "yellow" },
            { "value": ".jsx", "label": "JavaScript React", "color": "green" },
            { "value": ".json", "label": "JSON", "color": "gray" },
            { "value": ".md", "label": "Markdown", "color": "orange" },
            { "value": ".yaml", "label": "YAML", "color": "pink" },
            { "value": "other", "label": "Other", "color": "default" }
          ]
        },
        
        "language": {
          "type": "select",
          "display_name": "Programming Language",
          "description": "Primary programming language",
          "auto_detect": true,
          "options": [
            { "value": "typescript", "label": "TypeScript", "color": "blue" },
            { "value": "javascript", "label": "JavaScript", "color": "yellow" },
            { "value": "json", "label": "JSON", "color": "gray" },
            { "value": "markdown", "label": "Markdown", "color": "orange" },
            { "value": "yaml", "label": "YAML", "color": "pink" },
            { "value": "other", "label": "Other", "color": "default" }
          ]
        },
        
        "project_name": {
          "type": "select",
          "display_name": "Project",
          "description": "Project this file belongs to",
          "default": "dependency-linker",
          "options": [
            { "value": "dependency-linker", "label": "Dependency Linker", "color": "blue" }
          ]
        },
        
        "status": {
          "type": "select",
          "display_name": "Processing Status",
          "description": "Current processing state of the file",
          "default": "pending",
          "options": [
            { "value": "uploaded", "label": "Uploaded", "color": "green" },
            { "value": "updated", "label": "Updated", "color": "blue" },
            { "value": "pending", "label": "Pending", "color": "yellow" },
            { "value": "error", "label": "Error", "color": "red" }
          ]
        },
        
        "last_modified": {
          "type": "date",
          "display_name": "Last Modified",
          "description": "File modification timestamp",
          "auto_update": true
        },
        
        "dependencies_count": {
          "type": "number",
          "display_name": "Dependencies Count",
          "description": "Total number of dependencies"
        },
        "functions_count": {
          "type": "number", 
          "display_name": "Functions Count",
          "description": "Number of functions defined"
        },
        "classes_count": {
          "type": "number",
          "display_name": "Classes Count", 
          "description": "Number of classes defined"
        },
        "lines_of_code": {
          "type": "number",
          "display_name": "Lines of Code",
          "description": "Total lines of code"
        }
      },
      
      "relationships": {
        "dependencies": {
          "target": "dependencies",
          "type": "one_to_many",
          "display_name": "Dependencies",
          "description": "Files and libraries this file depends on"
        },
        
        "libraries": {
          "target": "libraries", 
          "type": "one_to_many",
          "display_name": "Libraries",
          "description": "External libraries used by this file"
        },
        
        "functions": {
          "target": "functions",
          "type": "one_to_many", 
          "display_name": "Functions",
          "description": "Functions defined in this file"
        },
        
        "imports": {
          "target": "files",
          "type": "many_to_many",
          "display_name": "Imports",
          "description": "Files that this file imports from",
          "reference_type": "database",
          "bidirectional": {
            "reverse_name": "Imported By",
            "reverse_description": "Files that import from this file",
            "auto_generate": true,
            "reverse_type": "many_to_many"
          }
        },
        
        "parent_directory": {
          "target": "self",
          "type": "many_to_one",
          "display_name": "Parent Directory",
          "description": "Parent directory of this file (for hierarchical structure)",
          "reference_type": "self",
          "bidirectional": {
            "reverse_name": "Child Files",
            "reverse_description": "Files contained in this directory",
            "auto_generate": true,
            "reverse_type": "one_to_many"
          }
        },
        
        "similar_files": {
          "target": "self", 
          "type": "many_to_many",
          "display_name": "Similar Files",
          "description": "Files with similar functionality or structure",
          "reference_type": "self",
          "bidirectional": {
            "reverse_name": "Similar Files",
            "reverse_description": "Files with similar functionality or structure",
            "auto_generate": false
          }
        }
      }
    },
    
    "dependencies": {
      "display_name": "Dependencies",
      "description": "Track all file dependencies and import relationships",
      "icon": "üì¶",
      "category": "relationship",
      
      "properties": {
        "type": {
          "type": "select",
          "display_name": "Dependency Type",
          "description": "Type of dependency relationship",
          "required": true,
          "options": [
            { "value": "local", "label": "Local File", "color": "blue" },
            { "value": "library", "label": "External Library", "color": "green" },
            { "value": "builtin", "label": "Built-in Module", "color": "gray" }
          ]
        },
        
        "source": {
          "type": "text",
          "display_name": "Source",
          "description": "Source file path or identifier",
          "searchable": true
        },
        
        "target": {
          "type": "text", 
          "display_name": "Target",
          "description": "Target module or file path",
          "searchable": true
        },
        
        "is_local": {
          "type": "checkbox",
          "display_name": "Is Local Dependency",
          "description": "Whether this is a local project dependency"
        },
        
        "is_dev_dependency": {
          "type": "checkbox",
          "display_name": "Is Dev Dependency", 
          "description": "Whether this is a development-only dependency"
        },
        
        "line_number": {
          "type": "number",
          "display_name": "Line Number",
          "description": "Line where the import/require statement appears"
        },
        
        "resolved_path": {
          "type": "text",
          "display_name": "Resolved Path",
          "description": "Fully resolved file system path"
        },
        
        "module_specifier": {
          "type": "text",
          "display_name": "Module Specifier", 
          "description": "Original import string as written in code"
        }
      },
      
      "relationships": {}
    },
    
    "libraries": {
      "display_name": "External Libraries",
      "description": "External packages and libraries used in the project",
      "icon": "üìö",
      "category": "external",
      
      "properties": {
        "version": {
          "type": "text",
          "display_name": "Version",
          "description": "Library version number",
          "searchable": true
        },
        
        "package_manager": {
          "type": "select",
          "display_name": "Package Manager",
          "description": "Package manager used to install this library",
          "options": [
            { "value": "npm", "label": "npm", "color": "red" },
            { "value": "yarn", "label": "Yarn", "color": "blue" },
            { "value": "pnpm", "label": "pnpm", "color": "orange" },
            { "value": "bun", "label": "Bun", "color": "yellow" },
            { "value": "pip", "label": "pip (Python)", "color": "green" },
            { "value": "cargo", "label": "Cargo (Rust)", "color": "orange" },
            { "value": "go-mod", "label": "Go Modules", "color": "blue" }
          ]
        },
        
        "category": {
          "type": "select",
          "display_name": "Category",
          "description": "Library category or purpose",
          "options": [
            { "value": "framework", "label": "Framework", "color": "purple" },
            { "value": "library", "label": "Library", "color": "blue" },
            { "value": "utility", "label": "Utility", "color": "green" },
            { "value": "dev-tool", "label": "Dev Tool", "color": "orange" },
            { "value": "testing", "label": "Testing", "color": "yellow" },
            { "value": "build-tool", "label": "Build Tool", "color": "red" }
          ]
        },
        
        "language": {
          "type": "select",
          "display_name": "Language",
          "description": "Primary language this library is written in",
          "options": [
            { "value": "typescript", "label": "TypeScript", "color": "blue" },
            { "value": "javascript", "label": "JavaScript", "color": "yellow" },
            { "value": "python", "label": "Python", "color": "green" },
            { "value": "go", "label": "Go", "color": "purple" },
            { "value": "rust", "label": "Rust", "color": "red" }
          ]
        },
        
        "is_dev_dependency": {
          "type": "checkbox", 
          "display_name": "Is Dev Dependency",
          "description": "Whether this is a development-only dependency"
        },
        
        "description": {
          "type": "text",
          "display_name": "Description",
          "description": "Brief description of what this library does"
        },
        
        "project_name": {
          "type": "select",
          "display_name": "Project",
          "description": "Project using this library",
          "default": "dependency-linker",
          "options": [
            { "value": "dependency-linker", "label": "Dependency Linker", "color": "blue" }
          ]
        }
      },
      
      "relationships": {}
    },
    
    "functions": {
      "display_name": "Functions",
      "description": "Functions, methods, and procedures defined in project files",
      "icon": "‚öôÔ∏è",
      "category": "code",
      
      "properties": {
        "file_path": {
          "type": "text",
          "display_name": "File Path", 
          "description": "Path to the file containing this function",
          "searchable": true
        },
        
        "language": {
          "type": "select",
          "display_name": "Language",
          "description": "Programming language",
          "options": [
            { "value": "typescript", "label": "TypeScript", "color": "blue" },
            { "value": "javascript", "label": "JavaScript", "color": "yellow" },
            { "value": "python", "label": "Python", "color": "green" },
            { "value": "go", "label": "Go", "color": "purple" },
            { "value": "rust", "label": "Rust", "color": "red" }
          ]
        },
        
        "line_number": {
          "type": "number",
          "display_name": "Line Number",
          "description": "Line number where function is defined"
        },
        
        "parameters_count": {
          "type": "number",
          "display_name": "Parameters Count",
          "description": "Number of function parameters"
        },
        
        "return_type": {
          "type": "text",
          "display_name": "Return Type",
          "description": "Function return type (if available)"
        },
        
        "is_async": {
          "type": "checkbox",
          "display_name": "Is Async",
          "description": "Whether this is an async function"
        },
        
        "is_exported": {
          "type": "checkbox",
          "display_name": "Is Exported", 
          "description": "Whether this function is exported from its module"
        },
        
        "complexity": {
          "type": "select",
          "display_name": "Complexity",
          "description": "Function complexity level",
          "options": [
            { "value": "low", "label": "Low", "color": "green" },
            { "value": "medium", "label": "Medium", "color": "yellow" },
            { "value": "high", "label": "High", "color": "red" }
          ]
        },
        
        "description": {
          "type": "text",
          "display_name": "Description",
          "description": "Function description or documentation"
        },
        
        "project_name": {
          "type": "select",
          "display_name": "Project",
          "description": "Project this function belongs to",
          "default": "dependency-linker", 
          "options": [
            { "value": "dependency-linker", "label": "Dependency Linker", "color": "blue" }
          ]
        }
      },
      
      "relationships": {}
    },
    
    "classes": {
      "display_name": "Classes",
      "description": "Classes, interfaces, and types defined in project files",
      "icon": "üèóÔ∏è",
      "category": "code",
      
      "properties": {
        "file_path": {
          "type": "text",
          "display_name": "File Path",
          "description": "Path to the file containing this class",
          "searchable": true
        },
        
        "language": {
          "type": "select",
          "display_name": "Language",
          "description": "Programming language",
          "options": [
            { "value": "typescript", "label": "TypeScript", "color": "blue" },
            { "value": "javascript", "label": "JavaScript", "color": "yellow" },
            { "value": "python", "label": "Python", "color": "green" },
            { "value": "go", "label": "Go", "color": "purple" },
            { "value": "rust", "label": "Rust", "color": "red" }
          ]
        },
        
        "line_number": {
          "type": "number",
          "display_name": "Line Number",
          "description": "Line number where class is defined"
        },
        
        "methods_count": {
          "type": "number",
          "display_name": "Methods Count",
          "description": "Number of methods in this class"
        },
        
        "properties_count": {
          "type": "number",
          "display_name": "Properties Count",
          "description": "Number of properties in this class"
        },
        
        "is_exported": {
          "type": "checkbox",
          "display_name": "Is Exported",
          "description": "Whether this class is exported from its module"
        },
        
        "is_abstract": {
          "type": "checkbox",
          "display_name": "Is Abstract",
          "description": "Whether this is an abstract class"
        },
        
        "extends": {
          "type": "text",
          "display_name": "Extends",
          "description": "Parent class name (if any)"
        },
        
        "implements": {
          "type": "text",
          "display_name": "Implements",
          "description": "Interfaces implemented (comma-separated)"
        },
        
        "description": {
          "type": "text",
          "display_name": "Description",
          "description": "Class description or documentation"
        },
        
        "project_name": {
          "type": "select",
          "display_name": "Project",
          "description": "Project this class belongs to",
          "default": "dependency-linker",
          "options": [
            { "value": "dependency-linker", "label": "Dependency Linker", "color": "blue" }
          ]
        }
      },
      
      "relationships": {
        "parent_class": {
          "target": "self",
          "type": "many_to_one", 
          "display_name": "Parent Class",
          "description": "Class that this class extends from",
          "reference_type": "self",
          "bidirectional": {
            "reverse_name": "Child Classes",
            "reverse_description": "Classes that extend from this class",
            "auto_generate": true,
            "reverse_type": "one_to_many"
          }
        },
        
        "implemented_interfaces": {
          "target": "self",
          "type": "many_to_many",
          "display_name": "Implemented Interfaces", 
          "description": "Interfaces implemented by this class",
          "reference_type": "self",
          "bidirectional": {
            "reverse_name": "Implementing Classes",
            "reverse_description": "Classes that implement this interface",
            "auto_generate": true,
            "reverse_type": "many_to_many"
          }
        },
        
        "used_classes": {
          "target": "self",
          "type": "many_to_many",
          "display_name": "Used Classes",
          "description": "Other classes this class depends on or uses",
          "reference_type": "self",
          "bidirectional": {
            "reverse_name": "Used By Classes",
            "reverse_description": "Classes that use or depend on this class", 
            "auto_generate": true,
            "reverse_type": "many_to_many"
          }
        },
        
        "defined_in_file": {
          "target": "files",
          "type": "many_to_one",
          "display_name": "Defined In File",
          "description": "File where this class is defined",
          "reference_type": "database",
          "bidirectional": {
            "reverse_name": "Defined Classes",
            "reverse_description": "Classes defined in this file",
            "auto_generate": true,
            "reverse_type": "one_to_many"
          }
        }
      }
    },
    
    "relationships": {
      "display_name": "File Relationships",
      "description": "Track complex relationships between project components",
      "icon": "üîÑ",
      "category": "relationship",
      
      "properties": {
        "relationship_type": {
          "type": "select",
          "display_name": "Relationship Type",
          "description": "Type of relationship between entities",
          "required": true,
          "options": [
            { "value": "imports", "label": "Imports", "color": "blue" },
            { "value": "extends", "label": "Extends", "color": "green" },
            { "value": "implements", "label": "Implements", "color": "purple" },
            { "value": "uses", "label": "Uses", "color": "orange" },
            { "value": "calls", "label": "Function Call", "color": "yellow" },
            { "value": "references", "label": "References", "color": "gray" }
          ]
        },
        
        "source_type": {
          "type": "select",
          "display_name": "Source Type",
          "description": "Type of the source entity",
          "options": [
            { "value": "file", "label": "File", "color": "blue" },
            { "value": "function", "label": "Function", "color": "green" },
            { "value": "class", "label": "Class", "color": "purple" },
            { "value": "variable", "label": "Variable", "color": "orange" }
          ]
        },
        
        "target_type": {
          "type": "select",
          "display_name": "Target Type",
          "description": "Type of the target entity",
          "options": [
            { "value": "file", "label": "File", "color": "blue" },
            { "value": "function", "label": "Function", "color": "green" },
            { "value": "class", "label": "Class", "color": "purple" },
            { "value": "variable", "label": "Variable", "color": "orange" }
          ]
        },
        
        "strength": {
          "type": "select",
          "display_name": "Relationship Strength",
          "description": "How strongly coupled these entities are",
          "options": [
            { "value": "weak", "label": "Weak", "color": "green" },
            { "value": "moderate", "label": "Moderate", "color": "yellow" },
            { "value": "strong", "label": "Strong", "color": "red" }
          ]
        },
        
        "description": {
          "type": "text",
          "display_name": "Description",
          "description": "Description of this relationship"
        }
      },
      
      "relationships": {
        "source_file": {
          "target": "files",
          "type": "many_to_one",
          "display_name": "Source File",
          "description": "File where this relationship originates"
        },
        
        "target_file": {
          "target": "files", 
          "type": "many_to_one",
          "display_name": "Target File",
          "description": "File that is the target of this relationship"
        }
      }
    }
  }
}